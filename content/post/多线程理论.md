
+++
tags = ["java"]
title = "多线程理论"
draft = false
date = "2017-02-15T10:54:24+02:00"

+++



1、为什么需要多线程编程

我们知道目前我们计算机基本是基于X86架构的，而基于X86架构的机器主频超不过4GHz，随着信息时代的来临，我们需要处理的数据越来越大，因此对程序的性能也要求越来越高，提高程序的性能，一方面需要提高运行环境的配置，也就是配性能更好的机器，更快的CPU更大的内存，另一方面就是优化自己的程序，从前者的角度考虑，我们说当前计算机的CPU主频已经接近顶级，一段时间内不可能再高，也就是说想通过提高机器的性能来加快程序的运行是一个不好的选择，因为你需要投入更多的硬件。同时其实我们的程序在运行的时候，CPU很多时候都是空闲的状态，因为程序不光有CPU调度，而大多数耗时的操作都在于IO上，我们知道程序的运行速度取决于木桶原理，CPU再快IO跟不上也没有用。所以我们需要合理利用空闲的CPU，当IO在处理其它的时候，CPU可以继续工作，这就是多线程编程。多线程编程的好处，总结一句话就是：合理利用CPU的空闲时间，来提高程序的性能。用我自己喜欢的一句话就是：有了多线程编程，我们可以告别摩尔定律，在这样一个多核的时代，写一个多线程的应用，总觉得比购置大量的多核硬件来的轻松、实在！

2、什么是Java多线程编程

Java语言本身就是多线程的，因此为我们开发者提供了语言级的多线程支持，这个要比C/C++中使用多线程方便的多，同时Java为我们提供了很多便利的条件，使得我们开发多线程应用方便了很多，但是这也是相对而言的，想要开发出一个真正意义上的多线程应用很难，因为有太多的问题需要考虑，看得见的和看不见的。所以我们必须从理论上打好基础，然后做大量的练习，真正的了解多线程的机制，不断实践，才能写出漂亮的并发应用来。

3、利用多线程开发解决哪些问题

在Java里有很多地方都在用多线程实现，尽管有时你没有发现，如Swing和SWT开发，当我们点击一个按钮时，我们总不能等待后台的数据处理完在给我们跳转吧，这样用户体验实在是太差了，我们可以先完成跳转，再加一些可以让用户等待的业务（如缓冲条等），然后再呈现结果。还有如我们开发Web时必用的Servlet，天生具有多线程性质，因为对于网站来说，同时又多个访问是最起码的需求，我们绝对不可能一个接一个的处理请求，那样根本不符合现实。这些地方就用到了多线程，并发地处理多个请求，提高程序的响应速度。

4、多线程编程的利弊

说了这么多，也许会给大家带来一个印象：多线程总会让程序跑的更快，所以我们应该多多使用。其实任何事物具有两面性，多线程也会带来一些负面的东西，如完美的解决并发带来的线程安全（这个问题很不好解决，也是处理多线程问题最棘手的事情，而且解决现程安全就会用到同步，同步的话又会带来性能的下降），所以从开发难度、硬件需求、维护成本等方面综合考虑，我们还是得根据实际情况来决定，到底需不需要多线程，或者哪部分需要，都是值得商榷的事儿。

5、进程和线程的关系

这个问题很经典，无数面试官想从这个问题得到你对线程和进程的理解程度，想完全讲清楚有点儿难度，同时也需要篇幅。从程序开发角度来讲，进程是资源分配的基本单位，是一个程序或者服务的基本单位。我们可以说进程就是程序的执行过程，这个过程包括很多东西，如CPU执行时间、运行内存、数据等，而且是一个动态的过程。线程是轻量级的进程，它们是共享在父进程拥有的资源下，每个线程在父进程的环境中顺序的独立的执行一个活动，每个CPU核心在同一时刻只能执行一个线程，尽管我们有时感觉自己的计算机同时开着多个任务，其实他们每个的执行都是走走停停的，CPU轮流给每个进程及线程分配时间。总结一下二者关系：

a>.一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程。线程是操作系统可识别的最小执行和调度单位。
b>.资源分配给进程，同一进程的所有线程共享该进程的所有资源。 同一进程中的多个线程共享代码段(代码和常量)，数据段(全局变量和静态变量)，扩展段(堆存储)。但是每个线程拥有自己的栈段，栈段又叫运行时段，用来存放所有局部变量和临时变量。
c>.处理机分给线程，即真正在处理机上运行的是线程。
d>.线程在执行过程中，需要协作同步。不同进程的线程间要利用消息通信的办法实现同步。