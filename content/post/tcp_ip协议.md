+++
tags = ["web"]
title = "tcp/ip协议"
draft = false
date = "2017-02-14T22:54:24+02:00"

+++


TCP/IP协议是一个协议集合。大家叫的时候方便说，所以统称为TCP/IP。TCP/IP协议族中有一个重要的概念是分层，TCP/IP协议按照层次分为以下四层。应用层、传输层、网络层、数据链路层。为什么要分层？这就如同邓小平1978年的大包干，责任到人。一个层只负责一个层次的问题，如果出问题了，和其他的层次无关，只要维护这个层次也就好了。其实编程语言里也能体现这个分层理论，即封转性、隔离。这里不再延伸细谈。下面我是制作的一个简图


TCP/IP 定义了电子设备如何连入因特网，以及数据如何在它们之间传输的标准.协议采用了4层的层级结构，每一层都呼叫它的下一层所提供的协议来完成自己的需求

![](http://i.imgur.com/n5bIE69.png)

下面是从网络上找到的TCP/IP通信数据流

![](http://i.imgur.com/bn9rVgw.jpg)



与osi模型的对比


![](http://i.imgur.com/Q6qMOiA.jpg)


##### tcp的三次握手

TCP负责发现传输的问题，保证数据安全的传输

![](http://i.imgur.com/YqbnTT8.jpg)

![](http://i.imgur.com/GlGzn4X.png)



##### ip协议

IP协议的作用在于把各种数据包准确无误的传递给对方，

IP协议是找到对方的详细地址

TCP协议就是把安全的把东西带给对方

TCP是传输层 ，IP是网络层.





连接终止协议（四次挥手） 

由于TCP连接是全双工的，因此每个方向都必须单独进行关闭。这原则是当一方完成它的数据发送任务后就能发送一个FIN来终止这个方向的连接。收到一个 FIN只意味着这一方向上没有数据流动，一个TCP连接在收到一个FIN后仍能发送数据。首先进行关闭的一方将执行主动关闭，而另一方执行被动关闭。

	（1） TCP客户端发送一个FIN，用来关闭客户到服务器的数据传送（报文段4）。
	（2） 服务器收到这个FIN，它发回一个ACK，确认序号为收到的序号加1（报文段5）。和SYN一样，一个FIN将占用一个序号。
	（3） 服务器关闭客户端的连接，发送一个FIN给客户端（报文段6）。
	（4） 客户段发回ACK报文确认，并将确认序号设置为收到序号加1（报文段7）。